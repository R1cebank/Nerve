(function() {
  var uuid, winston;

  uuid = require('node-uuid');

  winston = require('winston');

  module.exports = function(socket) {
    var clientUUID;
    clientUUID = uuid.v1();
    socket.emit('handshake', {
      uuid: clientUUID
    });
    winston.info('client is connected');
    socket.on('disconnect', function() {
      return winston.info('client disconnected');
    });
    socket.on('login', function(data) {
      return winston.info('client trying to login.');
    });
    socket.on('post', function(data) {
      clientUUID = validateClient(data.accessToken);
      if (clientUUID != null) {
        return winston.info('user ' + clientUUID + ' is allowed for action: post');
      } else {
        return winston.error('client is not authorized for such action');
      }
    });
    socket.on('ping', function() {
      return winston.info('recieved ping from MotionDex/Mocha, keep alive.');
    });
    return socket.on('error', function(err) {
      return raygunClient.send(err);
    });
  };

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImV2ZW50cy5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQSxNQUFBLGFBQUE7O0FBQUEsRUFBQSxJQUFBLEdBQU8sT0FBQSxDQUFTLFdBQVQsQ0FBUCxDQUFBOztBQUFBLEVBQ0EsT0FBQSxHQUFVLE9BQUEsQ0FBUyxTQUFULENBRFYsQ0FBQTs7QUFBQSxFQUdBLE1BQU0sQ0FBQyxPQUFQLEdBQWlCLFNBQUMsTUFBRCxHQUFBO0FBQ2YsUUFBQSxVQUFBO0FBQUEsSUFBQSxVQUFBLEdBQWEsSUFBSSxDQUFDLEVBQUwsQ0FBQSxDQUFiLENBQUE7QUFBQSxJQUNBLE1BQU0sQ0FBQyxJQUFQLENBQWEsV0FBYixFQUNFO0FBQUEsTUFBQSxJQUFBLEVBQU0sVUFBTjtLQURGLENBREEsQ0FBQTtBQUFBLElBR0EsT0FBTyxDQUFDLElBQVIsQ0FBYyxxQkFBZCxDQUhBLENBQUE7QUFBQSxJQUlBLE1BQU0sQ0FBQyxFQUFQLENBQVcsWUFBWCxFQUF3QixTQUFBLEdBQUE7YUFDdEIsT0FBTyxDQUFDLElBQVIsQ0FBYyxxQkFBZCxFQURzQjtJQUFBLENBQXhCLENBSkEsQ0FBQTtBQUFBLElBTUEsTUFBTSxDQUFDLEVBQVAsQ0FBVyxPQUFYLEVBQW1CLFNBQUMsSUFBRCxHQUFBO2FBSWpCLE9BQU8sQ0FBQyxJQUFSLENBQWMseUJBQWQsRUFKaUI7SUFBQSxDQUFuQixDQU5BLENBQUE7QUFBQSxJQVdBLE1BQU0sQ0FBQyxFQUFQLENBQVcsTUFBWCxFQUFrQixTQUFDLElBQUQsR0FBQTtBQUNoQixNQUFBLFVBQUEsR0FBYSxjQUFBLENBQWUsSUFBSSxDQUFDLFdBQXBCLENBQWIsQ0FBQTtBQUNBLE1BQUEsSUFBRyxrQkFBSDtlQUVFLE9BQU8sQ0FBQyxJQUFSLENBQWMsT0FBQSxHQUFTLFVBQVQsR0FBdUIsOEJBQXJDLEVBRkY7T0FBQSxNQUFBO2VBSUUsT0FBTyxDQUFDLEtBQVIsQ0FBZSwwQ0FBZixFQUpGO09BRmdCO0lBQUEsQ0FBbEIsQ0FYQSxDQUFBO0FBQUEsSUFrQkEsTUFBTSxDQUFDLEVBQVAsQ0FBVyxNQUFYLEVBQWtCLFNBQUEsR0FBQTthQUNoQixPQUFPLENBQUMsSUFBUixDQUFjLGlEQUFkLEVBRGdCO0lBQUEsQ0FBbEIsQ0FsQkEsQ0FBQTtXQW9CQSxNQUFNLENBQUMsRUFBUCxDQUFXLE9BQVgsRUFBbUIsU0FBQyxHQUFELEdBQUE7YUFDakIsWUFBWSxDQUFDLElBQWIsQ0FBa0IsR0FBbEIsRUFEaUI7SUFBQSxDQUFuQixFQXJCZTtFQUFBLENBSGpCLENBQUE7QUFBQSIsImZpbGUiOiJldmVudHMuanMiLCJzb3VyY2VSb290IjoiL3NvdXJjZS8iLCJzb3VyY2VzQ29udGVudCI6WyJ1dWlkID0gcmVxdWlyZSAnbm9kZS11dWlkJ1xud2luc3RvbiA9IHJlcXVpcmUgJ3dpbnN0b24nXG5cbm1vZHVsZS5leHBvcnRzID0gKHNvY2tldCkgLT5cbiAgY2xpZW50VVVJRCA9IHV1aWQudjEoKVxuICBzb2NrZXQuZW1pdCAnaGFuZHNoYWtlJyxcbiAgICB1dWlkOiBjbGllbnRVVUlEXG4gIHdpbnN0b24uaW5mbyAnY2xpZW50IGlzIGNvbm5lY3RlZCdcbiAgc29ja2V0Lm9uICdkaXNjb25uZWN0JywgLT5cbiAgICB3aW5zdG9uLmluZm8gJ2NsaWVudCBkaXNjb25uZWN0ZWQnXG4gIHNvY2tldC5vbiAnbG9naW4nLCAoZGF0YSkgLT4gIyNkYXRhPXtuYW1lOiAnbmFtZScsIHBhc3N3b3JkOidwYXNzd29yZCd9XG4gICAgIyNNb25nb0RiIGFjdGlvbiBoZXJlXG4gICAgIyNBY2Nlc3MgdG9rZW4gaXMgZ2VuZXJhdGVkIHVzaW5nIHRoZSB1c2VySUQgKyBjdXJyZW50VGltZSArIGRldmljZSBpZGVudGlmaWVyXG4gICAgIyNcbiAgICB3aW5zdG9uLmluZm8gJ2NsaWVudCB0cnlpbmcgdG8gbG9naW4uJ1xuICBzb2NrZXQub24gJ3Bvc3QnLCAoZGF0YSkgLT4gIyN7dGl0bGU6ICcnLCBkZXNjcmlwdGlvbjogJycsIGRhdGU6ICcnLCB0YWdzOicnLCBza2lsbHM6JycsY29tcDogJycsIGxvY2F0aW9uOicnLCBleHBpcmU6JycsIHJlbWFya3M6JycsIGFjY2Vzc1Rva2VuOicnLCB1dWlkOicnfVxuICAgIGNsaWVudFVVSUQgPSB2YWxpZGF0ZUNsaWVudCBkYXRhLmFjY2Vzc1Rva2VuXG4gICAgaWYgY2xpZW50VVVJRD9cbiAgICAgICMjUG9zdCBzdHVmZlxuICAgICAgd2luc3Rvbi5pbmZvICd1c2VyICcgKyBjbGllbnRVVUlEICsgJyBpcyBhbGxvd2VkIGZvciBhY3Rpb246IHBvc3QnXG4gICAgZWxzZVxuICAgICAgd2luc3Rvbi5lcnJvciAnY2xpZW50IGlzIG5vdCBhdXRob3JpemVkIGZvciBzdWNoIGFjdGlvbidcbiAgc29ja2V0Lm9uICdwaW5nJywgLT5cbiAgICB3aW5zdG9uLmluZm8gJ3JlY2lldmVkIHBpbmcgZnJvbSBNb3Rpb25EZXgvTW9jaGEsIGtlZXAgYWxpdmUuJ1xuICBzb2NrZXQub24gJ2Vycm9yJywgKGVycikgLT5cbiAgICByYXlndW5DbGllbnQuc2VuZCBlcnJcbiJdfQ==